name: wasm
on: [push]
jobs: 
    release-wasm:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v2
            - uses: actions/setup-python@v1
            - uses: actions-rs/toolchain@v1
              with:
                toolchain: stable
                target: wasm32-unknown-unknown
                override: true
            - name: Install system dependencies 
              run: sudo apt-get install pkg-config libx11-dev libasound2-dev libudev-dev 
            - name: Install build dependencies
              run: |
                  pip install --user doit
                  curl https://rustwasm.github.io/wasm-pack/installer/init.sh -sSf | sh
            - name: Build wasm release
              run: python -m doit build-wasm-release
            - name: Finish
              run: echo "Finished workflow successfully!"
